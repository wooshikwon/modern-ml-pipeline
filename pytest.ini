[pytest]
# M1 MacBook Air 16GB 메모리 최적화 설정
# 병렬 실행 제한으로 OOM 방지

# 병렬 실행 워커 수 제한 (기본값은 CPU 코어 수)
# M1 MacBook Air는 8코어이지만, 메모리 제약으로 2-3개로 제한
addopts =
    -n 2
    --tb=short
    --strict-markers
    --disable-warnings
    -ra
    --cov=src
    --cov-report=html:htmlcov
    --cov-report=term-missing
    --cov-fail-under=90
    --maxfail=50
    --cov-append
    --dist=loadgroup

# 테스트 마커 정의
markers =
    unit: Unit tests (fast)
    integration: Integration tests (medium)
    e2e: End-to-end tests (slow)
    performance: Performance benchmarks
    asyncio: Asynchronous tests

# 테스트 디렉토리
testpaths = tests

# 테스트 파일 패턴
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# 타임아웃 설정 (성능 테스트를 위해 여유있게 설정)
timeout = 600

# 메모리 사용량 모니터링을 위한 설정
# 각 테스트 후 가비지 컬렉션 강제 실행
[pytest:ini]
garbage_collect = true