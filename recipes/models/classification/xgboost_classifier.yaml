# XGBoost Classifier: ê³ ì„±ëŠ¥ ê·¸ë˜ë””ì–¸íŠ¸ ë¶€ìŠ¤íŒ…
# ğŸš€ ì†ë„ì™€ ì„±ëŠ¥ì„ ëª¨ë‘ ì¡ì€ ìµœê³ ì˜ ë¶„ë¥˜ê¸°

name: "xgboost_classifier"

model:
  # XGBoost Classifier ì§ì ‘ ë™ì  import
  class_path: "xgboost.XGBClassifier"
  
  # Phase 1: Point-in-Time ì •í•©ì„± ìŠ¤í‚¤ë§ˆ
  loader:
    name: "email_spam_loader"
    source_uri: "recipes/sql/loaders/email_classification_features.sql"
    entity_schema:
      entity_columns: ["email_id", "sender_domain"]    # ì´ë©”ì¼-ë„ë©”ì¸ í˜ì–´
      timestamp_column: "received_datetime"            # ìˆ˜ì‹  ì‹œì 
  
  # ê¸°ì¡´: ML ì‘ì—…ë³„ ì„¸ë¶€ ì„¤ì • (Classification ì „ìš©)
  data_interface:
    task_type: "classification"
    target_column: "is_spam"              # ìŠ¤íŒ¸ ì—¬ë¶€ (0: ì •ìƒ, 1: ìŠ¤íŒ¸)
    class_weight: "balanced"              # ë¶ˆê· í˜• ë°ì´í„° ìë™ ì²˜ë¦¬
    average: "weighted"
    
  # Dictionary í˜•íƒœ í•˜ì´í¼íŒŒë¼ë¯¸í„° (XGBoost íŠ¹í™”)
  hyperparameters:
    # ë¶€ìŠ¤íŒ… íŒŒë¼ë¯¸í„°
    n_estimators: {type: "int", low: 100, high: 1000}
    learning_rate: {type: "float", low: 0.01, high: 0.3, log: true}
    max_depth: {type: "int", low: 3, high: 10}
    
    # ì •ê·œí™”
    reg_alpha: {type: "float", low: 0, high: 1}
    reg_lambda: {type: "float", low: 1, high: 10}
    
    # ìƒ˜í”Œë§
    subsample: {type: "float", low: 0.6, high: 1.0}
    colsample_bytree: {type: "float", low: 0.6, high: 1.0}
    
    # ê³ ì •ê°’
    random_state: 42
    n_jobs: -1
    verbosity: 0

  # í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ì„¤ì •
  hyperparameter_tuning:
    enabled: true
    n_trials: 100
    metric: "roc_auc"
    direction: "maximize"
  
  # Feature Store ê¸°ë°˜ í”¼ì²˜ ì¦ê°•
  augmenter:
    type: "feature_store"
    features:
      # ì´ë©”ì¼ ì½˜í…ì¸  íŠ¹ì„±
      - feature_namespace: "email_content"
        features: ["subject_length", "body_length", "html_ratio", "link_count"]
      
      # ë°œì‹ ì ì‹ ë¢°ë„
      - feature_namespace: "sender_reputation"
        features: ["domain_age", "spam_history", "whitelist_status", "authentication_score"]
      
      # ì–¸ì–´ì  íŠ¹ì„±
      - feature_namespace: "linguistic_features"
        features: ["spam_keywords_count", "urgency_indicators", "language_detection"]
      
      # ë©”íƒ€ë°ì´í„°
      - feature_namespace: "email_metadata"
        features: ["attachment_count", "recipient_count", "reply_to_differs"]

  # ì „ì²˜ë¦¬ ì„¤ì •
  preprocessor:
    name: "classification_preprocessor"
    params:
      criterion_col: null
      exclude_cols: ["email_id", "sender_domain", "received_datetime", "is_spam"]
      handle_missing: "median"
      scale_features: false        # XGBoostëŠ” ìŠ¤ì¼€ì¼ë§ ë¶ˆí•„ìš”
      encode_categorical: "label"

  # í‰ê°€ì ì„¤ì •
  evaluator:
    name: "classification_evaluator"

# í‰ê°€ ì„¤ì •
evaluation:
  metrics:
    - "accuracy"
    - "precision_weighted"
    - "recall_weighted"
    - "f1_weighted"
    - "roc_auc"
  
  validation:
    method: "train_test_split"
    test_size: 0.2
    stratify: true
    random_state: 42
