# CatBoost Classifier: ë²”ì£¼í˜• ë°ì´í„°ì˜ ë§ˆë²•ì‚¬
# ğŸˆ ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ ìë™ìœ¼ë¡œ ì™„ë²½í•˜ê²Œ ì²˜ë¦¬í•˜ëŠ” ë˜‘ë˜‘í•œ ë¶€ìŠ¤íŒ…

name: "catboost_classifier"

model:
  # CatBoost Classifier ì§ì ‘ ë™ì  import
  class_path: "catboost.CatBoostClassifier"
  
  # Phase 1: Point-in-Time ì •í•©ì„± ìŠ¤í‚¤ë§ˆ
  loader:
    name: "credit_risk_assessment_loader"
    source_uri: "recipes/sql/loaders/credit_risk_features.sql"
    entity_schema:
      entity_columns: ["applicant_id", "application_id"]  # ì‹ ì²­ì-ì‹ ì²­ì„œ í˜ì–´
      timestamp_column: "application_date"                # ì‹ ì²­ ë‚ ì§œ
  
  # ê¸°ì¡´: ML ì‘ì—…ë³„ ì„¸ë¶€ ì„¤ì • (Classification ì „ìš©)
  data_interface:
    task_type: "classification"
    target_column: "credit_approved"      # ì‹ ìš© ìŠ¹ì¸ ì—¬ë¶€ (0: ê±°ì ˆ, 1: ìŠ¹ì¸)
    class_weight: "balanced"              # ìŠ¹ì¸/ê±°ì ˆ ê· í˜•
    average: "weighted"
    
  # Dictionary í˜•íƒœ í•˜ì´í¼íŒŒë¼ë¯¸í„° (CatBoost íŠ¹í™”)
  hyperparameters:
    # ë¶€ìŠ¤íŒ… íŒŒë¼ë¯¸í„°
    iterations: {type: "int", low: 100, high: 1500}       # CatBoostëŠ” iterations ì‚¬ìš©
    learning_rate: {type: "float", low: 0.01, high: 0.3, log: true}
    depth: {type: "int", low: 4, high: 10}                # CatBoostëŠ” depth ì‚¬ìš©
    
    # ì •ê·œí™”
    l2_leaf_reg: {type: "float", low: 1, high: 30}        # L2 ì •ê·œí™”
    bagging_temperature: {type: "float", low: 0, high: 1} # ë² ì´ì§€ì•ˆ ë¶€íŠ¸ìŠ¤íŠ¸ë©
    
    # ë²”ì£¼í˜• ì²˜ë¦¬ (CatBoost íŠ¹í™”)
    one_hot_max_size: {type: "int", low: 2, high: 25}     # One-hot ì„ê³„ê°’
    border_count: {type: "int", low: 32, high: 255}       # ê²½ê³„ ê°œìˆ˜
    
    # ê³ ì •ê°’
    random_state: 42
    verbose: false                                         # ì¡°ìš©í•œ ì‹¤í–‰
    class_weights: [1, 1]                                  # í´ë˜ìŠ¤ ê°€ì¤‘ì¹˜

  # í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ì„¤ì •
  hyperparameter_tuning:
    enabled: true
    n_trials: 80                      # CatBoostëŠ” ì•ˆì •ì ì´ë¯€ë¡œ ì ë‹¹íˆ
    metric: "roc_auc"
    direction: "maximize"
  
  # Feature Store ê¸°ë°˜ í”¼ì²˜ ì¦ê°•
  augmenter:
    type: "feature_store"
    features:
      # ê°œì¸ ì‹ ìš© ì •ë³´
      - feature_namespace: "personal_credit"
        features: ["credit_score", "employment_type", "income_level", "debt_to_income_ratio"]
      
      # ê³¼ê±° ê¸ˆìœµ ì´ë ¥
      - feature_namespace: "financial_history"
        features: ["previous_loans", "payment_delays", "bankruptcies", "credit_utilization"]
      
      # ì¸êµ¬í†µê³„í•™ì  íŠ¹ì„±
      - feature_namespace: "demographics"
        features: ["age_group", "education_level", "marital_status", "residence_type"]
      
      # ì‹ ì²­ ê´€ë ¨ ì •ë³´
      - feature_namespace: "application_details"
        features: ["loan_amount", "loan_purpose", "application_channel", "co_signer_present"]

  # ì „ì²˜ë¦¬ ì„¤ì • (CatBoostëŠ” ë²”ì£¼í˜• ìë™ ì²˜ë¦¬!)
  preprocessor:
    name: "classification_preprocessor"
    params:
      criterion_col: null
      exclude_cols: ["applicant_id", "application_id", "application_date", "credit_approved"]
      handle_missing: "median"
      scale_features: false        # CatBoostëŠ” ìŠ¤ì¼€ì¼ë§ ë¶ˆí•„ìš”
      encode_categorical: "none"   # CatBoostê°€ ìë™ìœ¼ë¡œ ë²”ì£¼í˜• ì²˜ë¦¬!

  # í‰ê°€ì ì„¤ì •
  evaluator:
    name: "classification_evaluator"

# í‰ê°€ ì„¤ì •
evaluation:
  metrics:
    - "accuracy"
    - "precision_weighted"
    - "recall_weighted"
    - "f1_weighted"
    - "roc_auc"
  
  validation:
    method: "train_test_split"
    test_size: 0.2
    stratify: true
    random_state: 42
