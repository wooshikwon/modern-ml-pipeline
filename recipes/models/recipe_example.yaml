# Recipe Example - Modern ML Pipeline í‘œì¤€ êµ¬ì¡° í…œí”Œë¦¿
# ğŸ¯ ìƒˆë¡œìš´ recipe ì‘ì„± ì‹œ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì™„ë²½í•œ í‘œì¤€ í…œí”Œë¦¿
# 
# ì´ íŒŒì¼ì€ Modern ML Pipelineì˜ ëª¨ë“  recipeê°€ ë”°ë¼ì•¼ í•  í‘œì¤€ êµ¬ì¡°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
# ìƒˆë¡œìš´ ëª¨ë¸ì„ ì¶”ê°€í•  ë•Œ ì´ í…œí”Œë¦¿ì„ ë³µì‚¬í•˜ê³  í•„ìš”í•œ ë¶€ë¶„ë§Œ ìˆ˜ì •í•˜ì„¸ìš”.

# ================================================================
# 1. MODEL IDENTIFICATION
# ================================================================
name: "recipe_example"  # ğŸ”¥ í•„ìˆ˜: recipe ê³ ìœ  ì‹ë³„ì

# ================================================================
# 2. MODEL CONFIGURATION
# ================================================================
model:
  # ì§ì ‘ ë™ì  importë¥¼ í†µí•œ ëª¨ë¸ í´ë˜ìŠ¤ ê²½ë¡œ
  class_path: "sklearn.ensemble.RandomForestClassifier"  # ğŸ”¥ í•„ìˆ˜: ì‹¤ì œ ëª¨ë¸ í´ë˜ìŠ¤
  
  # ================================================================
  # 2.1 HYPERPARAMETER DEFINITION (Optuna ìë™ ìµœì í™” ì§€ì›)
  # ================================================================
  hyperparameters:
    # ğŸ”¥ ìë™ ìµœì í™” ë²”ìœ„ - Optunaê°€ ìë™ìœ¼ë¡œ íƒìƒ‰í•  í•˜ì´í¼íŒŒë¼ë¯¸í„°
    n_estimators: {type: "int", low: 50, high: 500}
    max_depth: {type: "int", low: 3, high: 20}
    min_samples_split: {type: "int", low: 2, high: 20}
    min_samples_leaf: {type: "int", low: 1, high: 10}
    max_features: {type: "categorical", choices: ["sqrt", "log2", "auto"]}
    criterion: {type: "categorical", choices: ["gini", "entropy"]}
    
    # ğŸ”§ ê³ ì •ê°’ - ë³€ê²½ë˜ì§€ ì•ŠëŠ” ì•ˆì •ì„± ë³´ì¥ íŒŒë¼ë¯¸í„°
    random_state: 42
    n_jobs: -1  # ëª¨ë“  CPU ì½”ì–´ í™œìš©
    class_weight: "balanced"  # í´ë˜ìŠ¤ ë¶ˆê· í˜• ì²˜ë¦¬

  # ================================================================
  # 2.2 HYPERPARAMETER TUNING CONFIGURATION
  # ================================================================
  hyperparameter_tuning:
    enabled: true  # ğŸ”¥ HPO í™œì„±í™” ì—¬ë¶€
    n_trials: 100  # ì‹œë„í•  ìµœì í™” íšŸìˆ˜ (ëª¨ë¸ ë³µì¡ë„ì— ë”°ë¼ ì¡°ì •)
    metric: "f1_weighted"  # ìµœì í™”í•  ë©”íŠ¸ë¦­ (ì‘ì—… íƒ€ì…ë³„ë¡œ ë‹¤ë¦„)
    direction: "maximize"  # ë°©í–¥: maximize ë˜ëŠ” minimize

  # ================================================================
  # 2.3 DATA LOADER DEFINITION (Spine ìƒì„±)
  # ================================================================
  loader:
    name: "classification_loader"  # ë¡œë” ì‹ë³„ì
    source_uri: "recipes/sql/loaders/user_features.sql"  # SQL íŒŒì¼ ê²½ë¡œ

  # ================================================================
  # 2.4 FEATURE AUGMENTATION (Feature Store ê¸°ë°˜)
  # ================================================================
  augmenter:
    type: "feature_store"  # ğŸ”¥ ë°˜ë“œì‹œ "feature_store"ë¡œ ì„¤ì •
    features:
      # ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ í”¼ì²˜
      - feature_namespace: "user_demographics"
        features: ["age", "country_code"]
      
      # ì‚¬ìš©ì êµ¬ë§¤ ì´ë ¥ í”¼ì²˜  
      - feature_namespace: "user_purchase_summary"
        features: ["ltv", "total_purchase_count", "last_purchase_date"]
      
      # ìƒí’ˆ ìƒì„¸ ì •ë³´ í”¼ì²˜
      - feature_namespace: "product_details"
        features: ["price", "category", "brand"]
      
      # ì„¸ì…˜ í–‰ë™ í”¼ì²˜
      - feature_namespace: "session_summary"
        features: ["time_on_page_seconds", "click_count"]

  # ================================================================
  # 2.5 PREPROCESSING CONFIGURATION
  # ================================================================
  preprocessor:
    name: "simple_scaler"  # ì „ì²˜ë¦¬ê¸° íƒ€ì…
    params:
      criterion_col: null  # ê¸°ì¤€ ì»¬ëŸ¼ (ë³´í†µ null)
      # ğŸ”¥ ì¤‘ìš”: ì—”í‹°í‹° í‚¤ì™€ íƒ€ì„ìŠ¤íƒ¬í”„ëŠ” ë°˜ë“œì‹œ ì œì™¸
      exclude_cols: ["user_id", "product_id", "session_id", "event_timestamp"]

  # ================================================================
  # 2.6 DATA INTERFACE DEFINITION
  # ================================================================
  data_interface:
    task_type: "classification"  # ì‘ì—… íƒ€ì…: classification, regression, causal, clustering
    target_col: "target_label"  # íƒ€ê²Ÿ ì»¬ëŸ¼ëª…
    # treatment_col: "treatment"  # ì¸ê³¼ì¶”ë¡  ì „ìš©
    # treatment_value: "1"        # ì¸ê³¼ì¶”ë¡  ì „ìš©

  # ================================================================
  # 2.7 EVALUATOR CONFIGURATION
  # ================================================================
  evaluator:
    name: "classification_evaluator"  # í‰ê°€ì íƒ€ì…

# ================================================================
# 3. EVALUATION CONFIGURATION
# ================================================================
evaluation:
  # ì‘ì—…ë³„ íŠ¹í™” ë©”íŠ¸ë¦­ ì •ì˜
  metrics:
    - "accuracy"
    - "precision_weighted"
    - "recall_weighted" 
    - "f1_weighted"
    - "roc_auc"
  
  # ê²€ì¦ ë°©ë²• ì •ì˜
  validation:
    method: "train_test_split"  # ë˜ëŠ” "cross_validation", "unsupervised"
    test_size: 0.2
    stratify: true  # ë¶„ë¥˜ ì‘ì—…ì˜ ê²½ìš° í´ë˜ìŠ¤ ë¹„ìœ¨ ìœ ì§€
    random_state: 42

# ================================================================
# 4. USAGE EXAMPLE (ì‚¬ìš© ì˜ˆì‹œ)
# ================================================================
# ğŸ’¡ ì´ recipeë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ë²•:
# APP_ENV=dev uv run python main.py train --recipe-file models/recipe_example

# ================================================================
# 5. CUSTOMIZATION GUIDE (ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ì´ë“œ)
# ================================================================
# ğŸ”¥ ìƒˆë¡œìš´ recipe ì‘ì„± ì‹œ ìˆ˜ì •í•´ì•¼ í•  ì£¼ìš” ë¶€ë¶„:
#
# 1. name: recipe ê³ ìœ  ì´ë¦„ìœ¼ë¡œ ë³€ê²½
# 2. class_path: ì‚¬ìš©í•  ëª¨ë¸ í´ë˜ìŠ¤ë¡œ ë³€ê²½
# 3. hyperparameters: í•´ë‹¹ ëª¨ë¸ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¡œ ë³€ê²½
# 4. n_trials: ëª¨ë¸ ë³µì¡ë„ì— ë§ê²Œ ì¡°ì •
# 5. metric: ì‘ì—… íƒ€ì…ì— ë§ëŠ” ë©”íŠ¸ë¦­ìœ¼ë¡œ ë³€ê²½
# 6. data_interface.task_type: ì‘ì—… íƒ€ì… ë³€ê²½
# 7. data_interface.target_col: ì‹¤ì œ íƒ€ê²Ÿ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ë³€ê²½
# 8. evaluation.metrics: ì‘ì—… íƒ€ì…ì— ë§ëŠ” ë©”íŠ¸ë¦­ë“¤ë¡œ ë³€ê²½
# 9. evaluator.name: ì‘ì—… íƒ€ì…ì— ë§ëŠ” í‰ê°€ìë¡œ ë³€ê²½

# ================================================================
# 6. TASK TYPE SPECIFIC EXAMPLES (ì‘ì—…ë³„ íŠ¹í™” ì˜ˆì‹œ)
# ================================================================

# ğŸ¯ Classification (ë¶„ë¥˜):
# - task_type: "classification"
# - metrics: ["accuracy", "precision_weighted", "recall_weighted", "f1_weighted", "roc_auc"]
# - validation.stratify: true

# ğŸ“ˆ Regression (íšŒê·€):
# - task_type: "regression"  
# - metrics: ["r2_score", "mean_squared_error", "mean_absolute_error", "root_mean_squared_error"]
# - validation.stratify: false (ë˜ëŠ” ì œê±°)

# ğŸ¯ Causal (ì¸ê³¼ì¶”ë¡ ):
# - task_type: "causal"
# - treatment_col: "treatment"
# - treatment_value: "1"
# - metrics: ["uplift_auc", "uplift_at_k", "qini_coefficient", "treatment_effect"]
# - validation.stratify: true

# ğŸ” Clustering (í´ëŸ¬ìŠ¤í„°ë§):
# - task_type: "clustering"
# - target_col ì œê±° (ë¹„ì§€ë„ í•™ìŠµ)
# - metrics: ["silhouette_score", "calinski_harabasz_score", "davies_bouldin_score"]
# - validation.method: "unsupervised"

# ================================================================
# 7. TRIAL COUNT RECOMMENDATIONS (Trial ìˆ˜ ê¶Œì¥ì‚¬í•­)
# ================================================================
# - ê°„ë‹¨í•œ ëª¨ë¸ (Linear Regression, Naive Bayes): 20-30 trials
# - ì¤‘ê°„ ë³µì¡ë„ (Random Forest, SVM): 80-100 trials
# - ë³µì¡í•œ ëª¨ë¸ (XGBoost, LightGBM): 120-150 trials
# - ë§¤ìš° ë³µì¡í•œ ëª¨ë¸ (Neural Networks): 200+ trials 