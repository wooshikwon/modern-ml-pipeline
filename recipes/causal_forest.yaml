# recipes/causal_forest.yaml
# Causal Forest 모델을 위한 모든 정의가 포함된 "올인원" 레시피

# 1. 모델 기본 정보
name: "causal_forest"

# 2. 데이터 로더 정의
loader:
  name: "campaign_users"
  source_uri: "bq://recipes/sql/loaders/user_features.sql"
  local_override_uri: "file://local/data/sample_user_features.csv"

# 3. 피처 증강기 정의
augmenter:
  name: "point_in_time_features"
  source_uri: "bq://recipes/sql/features/user_summary.sql"
  local_override_uri: "file://local/data/sample_user_features.parquet"

# 4. 전처리기 정의
preprocessor:
  name: "simple_scaler"
  params:
    criterion_col: null
    exclude_cols: ["member_id", "event_timestamp"]

# 5. 모델 인터페이스 및 하이퍼파라미터
data_interface:
  features:
    gender: "category"
    age_group: "category"
    days_since_last_visit: "numeric"
    lifetime_purchase_count: "numeric"
    avg_purchase_amount_90d: "numeric"
    avg_session_duration_30d: "numeric"
  
  target_col: "outcome"
  treatment_col: "grp"
  treatment_value: "treatment"

hyperparameters:
  n_estimators: 100
  max_depth: 5
  min_samples_leaf: 10
  max_features: 0.7
  random_state: 42
