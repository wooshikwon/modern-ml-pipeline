# =============================================================================
# config/prod.yaml - í”„ë¡œë•ì…˜ í™˜ê²½ ì„¤ì • (base.yaml override)
# =============================================================================
# 
# ğŸ¯ PROD í™˜ê²½ ì² í•™: "ì„±ëŠ¥, ì•ˆì •ì„±, ê´€ì¸¡ ê°€ëŠ¥ì„±ì˜ ì™„ë²½í•œ ì‚¼ìœ„ì¼ì²´"
# - base.yamlì˜ ê¸°ë³¸ ì„¤ì •ì„ í”„ë¡œë•ì…˜ ìˆ˜ì¤€ìœ¼ë¡œ override
# - í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì„œë¹„ìŠ¤ í™œìš© 
# - ë¬´ì œí•œ í™•ì¥ì„±ê³¼ ìš´ì˜ ì•ˆì •ì„±
# - ì™„ì „í•œ ê´€ì¸¡ ê°€ëŠ¥ì„±ê³¼ ëª¨ë‹ˆí„°ë§
# =============================================================================

# í™˜ê²½ ì‹ë³„ì
environment:
  app_env: "prod"  # base.yaml override
  gcp_project_id: "${GCP_PROD_PROJECT_ID}"

# MLflow ì„¤ì • - í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ (base.yaml override)
mlflow:
  tracking_uri: "${MLFLOW_PROD_TRACKING_URI}"  # base.yaml override: í”„ë¡œë•ì…˜ ì„œë²„
  experiment_name: "Production-Models-${YEAR}"
  
  # ğŸŒ Use Caseë³„ MLflow ì„¤ì • ì˜ˆì‹œ:
  #
  # ğŸ¢ GCP í™˜ê²½:
  #   tracking_uri: "https://mlflow.your-company.com"
  #   artifact_location: "gs://mmp-prod-artifacts"
  #
  # â˜ï¸ AWS í™˜ê²½:  
  #   tracking_uri: "https://mlflow.amazonaws.com"
  #   artifact_location: "s3://mmp-prod-artifacts"
  #
  # ğŸ”µ Azure í™˜ê²½:
  #   tracking_uri: "https://mlflow.azureml.com"
  #   artifact_location: "abfss://artifacts@company.dfs.core.windows.net"

# ë°ì´í„° ì–´ëŒ‘í„° - SQL ìš°ì„  (base.yaml override)
data_adapters:
  default_loader: "sql"              # base.yaml override: SQL ìš°ì„ 
  default_storage: "storage"         # base.yaml ìœ ì§€
  default_feature_store: "feature_store"  # base.yaml ìœ ì§€
  
  adapters:
    # SQL ì–´ëŒ‘í„° - í”„ë¡œë•ì…˜ ë°ì´í„°ë² ì´ìŠ¤ (base.yaml override)
    sql:
      class_name: SqlAdapter
      config:
        # ğŸŒ Use Caseë³„ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •:
        #
        # ğŸ¢ BigQuery (GCP):
        connection_uri: "bigquery://${GCP_PROJECT_ID}/${DATASET_ID}"
        # job_config:
        #   maximum_bytes_billed: 1000000000  # 10GB ì œí•œ
        #   use_query_cache: true
        #
        # â„ï¸ Snowflake (Multi-cloud):
        # connection_uri: "snowflake://${SNOWFLAKE_USER}:${SNOWFLAKE_PASSWORD}@${SNOWFLAKE_ACCOUNT}/${SNOWFLAKE_DATABASE}/${SNOWFLAKE_SCHEMA}?warehouse=${SNOWFLAKE_WAREHOUSE}"
        #
        # ğŸ˜ PostgreSQL (Enterprise):
        # connection_uri: "postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:5432/${POSTGRES_DB}"
        # pool_size: 20
    
    # Storage ì–´ëŒ‘í„° - í´ë¼ìš°ë“œ ìŠ¤í† ë¦¬ì§€ (base.yaml override)
    storage:
      class_name: StorageAdapter
      config:
        # ğŸŒ Use Caseë³„ ìŠ¤í† ë¦¬ì§€ ì„¤ì •:
        #
        # ğŸ¢ Google Cloud Storage:
        storage_options:
          project: ${GCP_PROJECT_ID}
          token: ${GCS_SERVICE_ACCOUNT_KEY}
        #
        # â˜ï¸ AWS S3:
        # storage_options:
        #   key: ${AWS_ACCESS_KEY_ID}
        #   secret: ${AWS_SECRET_ACCESS_KEY}
        #   client_kwargs:
        #     region_name: ${AWS_REGION}

# Feature Store - í”„ë¡œë•ì…˜ í™˜ê²½ ì„¤ì • (base.yaml override)
feature_store:
  provider: "feast"
  feast_config:
    project: "mmp-prod"
    provider: "gcp"  # base.yaml override: í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ
    registry: "gs://mmp-prod-registry/registry.db"  # base.yaml override: í´ë¼ìš°ë“œ ì €ì¥ì†Œ
    
    # Offline Store - BigQuery (base.yaml override)
    offline_store:
      type: "bigquery"
      project_id: ${GCP_PROJECT_ID}
      dataset_id: "feature_store"
      
      # ğŸŒ Alternative Offline Stores:
      #
      # â„ï¸ Snowflake:
      # type: "snowflake"
      # account: ${SNOWFLAKE_ACCOUNT}
      # database: "FEATURE_STORE"
      # warehouse: "COMPUTE_WH"
    
    # Online Store - Redis í´ëŸ¬ìŠ¤í„° (base.yaml override)
    online_store:
      type: "redis"
      connection_string: ${REDIS_CONNECTION_STRING}
      ssl: true
      
      # ğŸŒ Alternative Online Stores:
      #
      # ğŸ—„ï¸ DynamoDB (AWS):
      # type: "dynamodb"
      # region: ${AWS_REGION}
      # table_name: "feast_online_store"

# í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ - í”„ë¡œë•ì…˜ ìµœì í™” (base.yaml override)
hyperparameter_tuning:
  enabled: true             # base.yaml override: í”„ë¡œë•ì…˜ì—ì„œëŠ” í™œì„±í™”
  timeout: 7200             # base.yaml override: 2ì‹œê°„ ì¶©ë¶„í•œ íƒìƒ‰
  
  pruning:
    n_startup_trials: 10    # base.yaml override: ì¶©ë¶„í•œ ì´ˆê¸° trial
    n_warmup_steps: 20      # base.yaml override
  
  parallelization:
    n_jobs: 16              # base.yaml override: ê³ ì„±ëŠ¥ ë³‘ë ¬ ì²˜ë¦¬

# API ì„œë¹™ - í”„ë¡œë•ì…˜ ì„œë¹™ (base.yaml override)
serving:
  enabled: true
  model_stage: "Production"  # base.yaml override: MLflow Production ìŠ¤í…Œì´ì§€
  
  # ğŸŒ Use Caseë³„ ì„œë¹™ ì„¤ì •:
  #
  # ğŸš€ ê³ ì„±ëŠ¥ ì„œë¹™:
  #   autoscaling:
  #     min_replicas: 3
  #     max_replicas: 100
  #     target_cpu_utilization: 70
  #
  # ğŸ”’ ë³´ì•ˆ ê°•í™”:
  #   security:
  #     enable_https: true
  #     require_api_key: true
  #     allowed_origins: ["https://company.com"]

# ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œ - í”„ë¡œë•ì…˜ í´ë¼ìš°ë“œ ì €ì¥ì†Œ (base.yaml override)
artifact_stores:
  # í”¼ì²˜ ì¦ê°• ë°ì´í„° (base.yaml override)
  augmented_dataset:
    enabled: true
    base_uri: "gs://mmp-prod-datasets/augmented"  # base.yaml override: í´ë¼ìš°ë“œ ì €ì¥ì†Œ
    
    # ğŸŒ Use Caseë³„ ì €ì¥ì†Œ ì„¤ì •:
    # base_uri: "s3://mmp-prod-datasets/augmented"              # AWS
    # base_uri: "abfss://datasets@company.dfs.core.windows.net" # Azure
    
  # ì „ì²˜ë¦¬ ë°ì´í„° - í”„ë¡œë•ì…˜ì—ì„œëŠ” í™œì„±í™” (base.yaml override)
  preprocessed_dataset:
    enabled: true           # base.yaml override: í”„ë¡œë•ì…˜ì—ì„œëŠ” ê°ì‚¬ìš© í™œì„±í™”
    base_uri: "gs://mmp-prod-datasets/preprocessed"  # base.yaml override: í´ë¼ìš°ë“œ ì €ì¥ì†Œ
    retention_days: 90      # 90ì¼ ë³´ê´€
    
  # ì˜ˆì¸¡ ê²°ê³¼ (base.yaml override)
  prediction_results:
    enabled: true
    base_uri: "gs://mmp-prod-predictions"  # base.yaml override: í´ë¼ìš°ë“œ ì €ì¥ì†Œ
    
    # ë°ì´í„° ê±°ë²„ë„ŒìŠ¤ (í”„ë¡œë•ì…˜ ì¶”ê°€ ì„¤ì •)
    governance:
      enable_lineage: true      # ë°ì´í„° ê³„ë³´ ì¶”ì 
      enable_versioning: true   # ë²„ì „ ê´€ë¦¬
      retention_policy: "5_years"  # 5ë…„ ë³´ê´€
    
    # PostgreSQL ì €ì¥ - í”„ë¡œë•ì…˜ DB (base.yaml override)
    postgres_storage:
      enabled: true
      table_name: "batch_predictions"
      connection_uri: "postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:5432/${POSTGRES_DB}"

# ë³´ì•ˆ ì„¤ì • (í”„ë¡œë•ì…˜ ì¶”ê°€)
security:
  enable_authentication: true
  api_key_required: true
  rate_limiting: true
  
# ëª¨ë‹ˆí„°ë§ ì„¤ì • (í”„ë¡œë•ì…˜ ì¶”ê°€)  
monitoring:
  enable_metrics: true
  enable_tracing: true
  enable_profiling: false  # ì„±ëŠ¥ìƒ ê¸°ë³¸ ë¹„í™œì„±í™”

# ğŸ’¡ ìš´ì˜ì ê°€ì´ë“œ:
#
# ğŸš€ í”„ë¡œë•ì…˜ ë°°í¬:
#   APP_ENV=prod uv run python main.py train --recipe-file production_model
#
# ğŸ“Š ë°°ì¹˜ ì¶”ë¡  ì‹¤í–‰:
#   APP_ENV=prod uv run python main.py batch-inference --run-id <PROD_RUN_ID>
#
# ğŸŒ API ì„œë²„ ì‹œì‘:
#   APP_ENV=prod uv run python main.py serve-api --run-id <PROD_RUN_ID> --host 0.0.0.0 --port 8080