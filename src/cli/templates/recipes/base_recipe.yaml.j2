# {{ environment.upper() }} 환경 {{ model_info.class_path.split('.')[-1] }} 레시피
# 자동 생성됨: {{ generation_date }}
name: "{{ recipe_name }}"

# 모델 설정 (catalog 기반)
model:
  class_path: "{{ model_info.class_path }}"
  library: "{{ model_info.library }}"
  description: "{{ model_info.description }}"
  
  # 하이퍼파라미터 (catalog + 환경별 오버라이드)
  hyperparameters:
    {% for key, value in hyperparameters.items() %}
    {{ key }}: {{ value }}
    {% endfor %}

# 데이터 설정 (환경별)
data:
  loader:
    name: "{{ data_config.loader_name }}"
    source_uri: "{{ data_config.source_uri }}"
    adapter: "{{ data_config.adapter }}"
  
  data_interface:
    task_type: "{{ task_type.lower() }}"
    target_column: "{{ data_config.target_column }}"
    {% if data_config.entity_columns %}
    entity_schema:
      entity_columns: {{ data_config.entity_columns }}
      {% if data_config.timestamp_column %}
      timestamp_column: "{{ data_config.timestamp_column }}"
      {% endif %}
    {% endif %}

# Feature Store 설정 (환경에 따라 조건부)
{% if environment_config.feature_store_enabled %}
augmenter:
  type: "feature_store"
  features:
    - feature_namespace: "{{ environment_config.feature_namespace | default('default_features') }}"
      features: {{ environment_config.feature_list | default(['feature_1', 'feature_2']) }}
{% endif %}

# 하이퍼파라미터 튜닝 설정
{% if environment_config.hyperparameter_tuning %}
hyperparameter_tuning:
  enabled: true
  n_trials: {{ environment_config.n_trials | default(50) }}
  metric: "{{ tuning_config.metric }}"
  direction: "{{ tuning_config.direction }}"
  search_space:
    {% for param_name, param_config in tunable_params.items() %}
    {{ param_name }}:
      type: "{{ param_config.type }}"
      {% if param_config.type == 'categorical' %}
      choices: {{ param_config.choices }}
      {% else %}
      range: {{ param_config.range }}
      {% endif %}
    {% endfor %}
{% else %}
hyperparameter_tuning:
  enabled: false
{% endif %}

# 평가 메트릭 (태스크별)
evaluation:
  metrics: {{ evaluation_metrics }}
  validation:
    method: "{{ validation_config.method | default('train_test_split') }}"
    test_size: {{ validation_config.test_size | default(0.2) }}
    random_state: {{ validation_config.random_state | default(42) }}

# 환경 설정
environment: "{{ environment }}"

# 메타데이터
metadata:
  generated_by: "mmp get-recipe"
  generation_date: "{{ generation_date }}"
  template_version: "1.0"