# LOCAL 환경 E2E 테스트용 Causal Recipe (v2)
# Mock 데이터 시스템 활용

name: "local_causal_test_v2"

model:
  # CausalML S-Learner
  class_path: "causalml.inference.meta.SLearner"
  
  # Phase 1: Point-in-Time 정합성 스키마
  loader:
    name: "causal_test_v2"
    source_uri: "tests/fixtures/sql/loaders/local_test_data.sql"
    adapter: sql
    entity_schema:
      entity_columns: ["user_id"]
      timestamp_column: "event_timestamp"
  
  # ML 작업별 세부 설정 (Causal 전용)
  data_interface:
    task_type: "causal"
    target_column: "outcome"
    treatment_column: "session_duration"  # Mock 데이터의 연속형 변수 사용
    treatment_value: 400  # 400 이상을 treatment로 간주
    
  # 간단한 하이퍼파라미터
  hyperparameters:
    base_learner: "random_forest"
    n_estimators: 10  # 빠른 테스트용
    max_depth: 3
    random_state: 42
    n_jobs: 1
    
  # 하이퍼파라미터 튜닝 비활성화
  hyperparameter_tuning:
    enabled: false

  # LOCAL 환경: 자동으로 PassThroughfetcher 사용됨
  fetcher:
    type: "feature_store"
    features: []

  # 기본적인 전처리만
  preprocessor:
    name: "local_causal_preprocessor"
    params:
      exclude_cols: ["user_id", "product_id", "event_timestamp"]
      handle_missing: "mean"
      scale_features: true
      encode_categorical: "none"

  # 기본 평가 설정
  evaluator:
    name: "causal_evaluator"
    
evaluation:
  metrics: ["uplift_at_k"]  # Causal용 메트릭
  validation:
    method: "train_test_split"
    test_size: 0.2
    random_state: 42
    
# 메타데이터
metadata:
  description: "LOCAL 환경 E2E 테스트용 Causal Recipe (Mock 데이터)"
  use_cases: ["테스트", "검증"] 